import pickle
import pandas as pd
import numpy as np
import json
import warnings

# Load the model from the .pkl file
with open('/home/ubuntu/volatility3/randomforestmodel.pkl', 'rb') as file:
    model = pickle.load(file)

# Load the test data
test_data = pd.read_csv('/home/ubuntu/volatility3/final.csv', header=None)

# Reshape the test data into the required shape (1 row, n columns)
test_data = np.reshape(test_data.values, (1, -1))

# Disable the warning about feature names
warnings.filterwarnings("ignore", category=UserWarning, module='sklearn')

# Make predictions on the test data
with warnings.catch_warnings():
    warnings.simplefilter("ignore")
    predictions = model.predict(test_data)

# Convert predictions to a list
predictions_list = predictions.tolist()

# Save predictions in a JSON file
output_file = 'output.json'
with open(output_file, 'w') as file:
    json.dump(predictions_list, file)
